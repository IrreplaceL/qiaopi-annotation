详细实现方案（伪代码）：

1. restful.py  
   - 使用 Flask 创建 RESTful API，定义 `/process` POST 路由，接收图片（form-data 或 base64）。
   - 保存图片到临时路径。
   - 调用 first.py 的主函数，传入图片路径，生成 `output/llm_input.json`。
   - 调用 dsApi.py 的主函数，读取 `output/llm_corrected.json`。
   - 返回 JSON 响应，包含状态码、消息、数据。

2. 修改 first.py  
   - 封装为函数 `run_ocr(file_path)`，参数为图片路径，返回 `llm_input.json` 路径。

3. 修改 dsApi.py  
   - 封装为函数 `run_llm(llm_input_path)`，参数为 `llm_input.json` 路径，返回 `llm_corrected.json` 路径。

---

first.py（重构为函数）：

```python
import os
import base64
import requests
import json

API_URL = "https://i6b9x5z7b2vdfaca.aistudio-app.com/ocr"
TOKEN = "###"

def run_ocr(file_path):
    input_filename = os.path.splitext(os.path.basename(file_path))[0]
    with open(file_path, "rb") as f:
        file_data = base64.b64encode(f.read()).decode("ascii")
    headers = {
        "Authorization": f"token {TOKEN}",
        "Content-Type": "application/json"
    }
    payload = {
        "file": file_data,
        "fileType": 1,
        "useDocOrientationClassify": False,
        "useDocUnwarping": False,
        "useTextlineOrientation": False
    }
    response = requests.post(API_URL, json=payload, headers=headers)
    response.raise_for_status()
    result = response.json()["result"]
    os.makedirs("output", exist_ok=True)
    llm_input = []
    for i, res in enumerate(result["ocrResults"]):
        pr = res["prunedResult"]
        rec_texts = pr["rec_texts"]
        rec_boxes = pr["rec_boxes"]
        rec_scores = pr["rec_scores"]
        for idx, text in enumerate(rec_texts):
            llm_input.append({
                "line_id": len(llm_input) + 1,
                "text": text,
                "bbox": rec_boxes[idx],
                "score": round(rec_scores[idx], 3)
            })
        # 可选：保存 OCR 可视化图片
        image_url = res["ocrImage"]
        img_response = requests.get(image_url)
        if img_response.status_code == 200:
            filename = f"output/{input_filename}_{i}.jpg"
            with open(filename, "wb") as f:
                f.write(img_response.content)
    llm_input_path = "output/llm_input.json"
    with open(llm_input_path, "w", encoding="utf-8") as f:
        json.dump(llm_input, f, ensure_ascii=False, indent=2)
    return llm_input_path
```

---

dsApi.py（重构为函数）：

```python
import os
import json
from openai import OpenAI

def run_llm(llm_input_path):
    client = OpenAI(
        api_key="##",
        base_url="https://api.deepseek.com"
    )
    with open(llm_input_path, "r", encoding="utf-8") as f:
        ocr_lines = json.load(f)
    system_prompt = """你是一名研究中国近现代侨批文献的文本校勘与信息标注专家，...（省略，保持原文）"""
    user_prompt = f"""下面给出 OCR 识别结果，请逐行处理。...（省略，保持原文）\n{json.dumps(ocr_lines, ensure_ascii=False, indent=2)}"""
    response = client.chat.completions.create(
        model="deepseek-chat",
        messages=[
            {"role": "system", "content": system_prompt},
            {"role": "user", "content": user_prompt}
        ],
        temperature=0.2
    )
    result_text = response.choices[0].message.content
    llm_corrected_path = "output/llm_corrected.json"
    with open(llm_corrected_path, "w", encoding="utf-8") as f:
        f.write(result_text)
    return llm_corrected_path
```

---

restful.py（主 RESTful API 文件）：

```python
from flask import Flask, request, jsonify
import os
import tempfile
import json
from first import run_ocr
from dsApi import run_llm

app = Flask(__name__)

@app.route('/process', methods=['POST'])
def process_image():
    if 'file' not in request.files:
        return jsonify({"code": 400, "msg": "No file part", "data": None}), 400
    file = request.files['file']
    if file.filename == '':
        return jsonify({"code": 400, "msg": "No selected file", "data": None}), 400
    # 保存临时图片
    with tempfile.NamedTemporaryFile(delete=False, suffix=os.path.splitext(file.filename)[1]) as tmp:
        file.save(tmp.name)
        tmp_path = tmp.name
    try:
        llm_input_path = run_ocr(tmp_path)
        llm_corrected_path = run_llm(llm_input_path)
        with open(llm_corrected_path, "r", encoding="utf-8") as f:
            data = json.load(f)
        return jsonify({"code": 200, "msg": "success", "data": data})
    except Exception as e:
        return jsonify({"code": 500, "msg": str(e), "data": None}), 500
    finally:
        os.remove(tmp_path)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
```

---

**注意事项：**
- restful.py 需安装 Flask。
- first.py、dsApi.py 需在同一目录下，且函数名与导入一致。
- 前端以 form-data 方式上传图片，字段名为 file。
- 响应为标准 JSON，包含 code/msg/data 字段。